@using Zoodex.Models
@using Zoodex.Functions
@{
    ViewBag.Title = "Home";
}

<section class="container-fluid p-0 pt-5 mt-4">
    @{ Users user = (Users)Session["User"]; }
    @if (user != null)
    {
        <div class="bg-light border-bottom main-header mb-4 py-5">
            <div class="bg-main-header bg-opacity-50 bg-black  pt-3 pb-3 rounded-pill">
                <div class="text-center my-5">
                    <h1 class="fw-bolder fs-1">
                        Welcome to Zoodex!
                    </h1>
                    <p class="lead mb-0 text-light fw-bold">
                        Discover reptiles and share them with the world.
                    </p>
                </div>
            </div>
        </div>
        <!-- Inicio de posts -->
        <div class="container">
            <div class="row">
                <p class="fw-bold green-light-text fs-2">
                    Recent discoveries:
                </p>
                @{List<PostModel> Posts = (List<PostModel>)ViewBag.Posts; }
                <!-- Descubrimientos-->
            <div class="col-lg-8">
                <!-- Más reciente-->
                @if (Posts.Count() >= 1)
                {
                    <div class="card mb-4">
                        <a href="@Url.Action("View","Post", new { Id = Posts[0].Id })"><img class="card-img-top" src="@Posts[0].Image" alt="Post @Posts[0].Id Image" width="300" height="300"/></a>
                        <div class="card-body h-25">
                            <div class="d-flex">
                                <!-- Poner foto/nombre/comentarios de cada usuario -->
                                <img src="@ImageHandler.GetProfilePicture(Posts[0].ProfileImageId)" alt="Profile picture" class="profile-picture rounded-circle mb-2">
                                <div class="small text-muted ms-2 mt-2">@Posts[0].PostedBy</div>
                            </div>
                            <h2 class="card-title">@Posts[0].Title</h2>
                            <p class="card-text text-truncate">@Posts[0].Content </p>
                            <a class="btn btn-success" href="@Url.Action("View","Post", new { Id = Posts[0].Id })">View Post →</a>
                        </div>
                    </div>
                }
                <!-- Otros descubrimientos -->
                <div class="row">
                    <div class="col-lg-6">
                        @if (Posts.Count() >= 2)
                        {
                            <!-- Descubrimientos, cargar automatico-->
                            <div class="card mb-4">
                                <a href="@Url.Action("View","Post", new { Id = Posts[1].Id })"><img class="card-img-top" src="@Posts[1].Image" alt="Post @Posts[1].Id Image" width="200" height="200"/></a>
                                <div class="card-body h-25">
                                    <div class="d-flex">
                                        <!-- Poner foto/nombre/comentarios de cada usuario -->
                                        <img src="@ImageHandler.GetProfilePicture(Posts[1].ProfileImageId)" alt="Profile picture" class="profile-picture rounded-circle mb-2">
                                        <div class="small text-muted ms-2 mt-2">@Posts[1].PostedBy</div>
                                    </div>
                                    <h2 class="card-title">@Posts[1].Title</h2>
                                    <p class="card-text text-truncate">@Posts[1].Content </p>
                                    <a class="btn btn-success" href="@Url.Action("View","Post", new { Id = Posts[1].Id })">View Post →</a>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="col-lg-6">
                        @if (Posts.Count() >= 3)
                        {
                            <!-- Descubrimientos, cargar automatico-->
                            <div class="card mb-4">
                                <a href="@Url.Action("View","Post", new { Id = Posts[2].Id })"><img class="card-img-top" src="@Posts[2].Image" alt="Post @Posts[2].Id Image" width="200" height="200" /></a>
                                <div class="card-body h-25">
                                    <div class="d-flex">
                                        <!-- Poner foto/nombre/comentarios de cada usuario -->
                                        <img src="@ImageHandler.GetProfilePicture(Posts[2].ProfileImageId)" alt="Profile picture" class="profile-picture rounded-circle mb-2">
                                        <div class="small text-muted ms-2 mt-2">@Posts[2].PostedBy</div>
                                    </div>
                                    <h2 class="card-title">@Posts[2].Title</h2>
                                    <p class="card-text text-truncate">@Posts[2].Content </p>
                                    <a class="btn btn-success" href="@Url.Action("View","Post", new { Id = Posts[2].Id })">View Post →</a>
                                </div>
                            </div>
                        }

                    </div>
                </div>

                <div class="row">
                    <div class="col-lg-6">
                        @if (Posts.Count() >= 4)
                        {
                            <!-- Descubrimientos, cargar automatico-->
                            <div class="card mb-4">
                                <a href="@Url.Action("View","Post", new { Id = Posts[3].Id })"><img class="card-img-top" src="@Posts[3].Image" alt="Post @Posts[3].Id Image" width="200" height="200" /></a>
                                <div class="card-body h-25">
                                    <div class="d-flex">
                                        <!-- Poner foto/nombre/comentarios de cada usuario -->
                                        <img src="@ImageHandler.GetProfilePicture(Posts[3].ProfileImageId)" alt="Profile picture" class="profile-picture rounded-circle mb-2">
                                        <div class="small text-muted ms-2 mt-2">@Posts[3].PostedBy</div>
                                    </div>
                                    <h2 class="card-title">@Posts[3].Title</h2>
                                    <p class="card-text text-truncate">@Posts[3].Content </p>
                                    <a class="btn btn-success" href="@Url.Action("View","Post", new { Id = Posts[3].Id })">View Post →</a>
                                </div>
                            </div>
                        }
                    </div>
                    <div class="col-lg-6">
                        @if (Posts.Count() >= 5)
                        {
                            <!-- Descubrimientos, cargar automatico-->
                            <div class="card mb-4">
                                <a href="@Url.Action("View","Post", new { Id = Posts[4].Id })"><img class="card-img-top" src="@Posts[4].Image" alt="Post @Posts[4].Id Image" width="200" height="200" /></a>
                                <div class="card-body h-25">
                                    <div class="d-flex">
                                        <!-- Poner foto/nombre/comentarios de cada usuario -->
                                        <img src="@ImageHandler.GetProfilePicture(Posts[4].ProfileImageId)" alt="Profile picture" class="profile-picture rounded-circle mb-2">
                                        <div class="small text-muted ms-2 mt-2">@Posts[4].PostedBy</div>
                                    </div>
                                    <h2 class="card-title">@Posts[4].Title</h2>
                                    <p class="card-text text-truncate">@Posts[4].Content </p>
                                    <a class="btn btn-success" href="@Url.Action("View","Post", new { Id = Posts[4].Id })">View Post →</a>
                                </div>
                            </div>
                        }
                    </div>
                </div>

                <!-- Paginacion-->
                <nav aria-label="Pagination">
                    <hr class="my-0" />
                    <ul class="pagination justify-content-center my-4 green-light-text">
                        @if (Request.Params["Page"] == null || Convert.ToInt32(Request.Params["Page"]) == 1)
                        {
                            <li class="page-item disabled"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = 1 })" tabindex="-1" aria-disabled="true">First</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = 1 })" tabindex="-1" aria-disabled="true">First</a></li>
                        }
                        @for (int i = 0; i < (int)ViewBag.TotalPages; i++)
                        {
                            int page = i + 1;
                            if (Request.Params["Page"] == null && page == 1)
                            {
                                <li class="page-item active" aria-current="page"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = page })">@page</a></li>
                            }
                            else if (Convert.ToInt32(Request.Params["Page"]) == page)
                            {
                                <li class="page-item active" aria-current="page"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = page })">@page</a></li>
                            }
                            else
                            {
                                <li class="page-item" aria-current="page"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = page })">@page</a></li>
                            }
                        }
                        @if ((int)ViewBag.TotalPages <= 1 || Convert.ToInt32(Request.Params["Page"]) == (int)ViewBag.TotalPages)
                        {
                            <li class="page-item disabled"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = ViewBag.TotalPages })">Last</a></li>
                        }
                        else
                        {
                            <li class="page-item"><a class="page-link" href="@Url.Action("Index", "Home", new { Page = ViewBag.TotalPages })">Last</a></li>
                        }
                    </ul>
                </nav>
            </div>
                <!-- Barra lateral-->
                <div class="col-lg-4">
                    <!-- Info-->
                    <div class="card mb-4">
                        <div class="card-body">
                            <div class="">
                                <div class="">
                                    <ul class="list-unstyled mb-0 fs-4">
                                        <li>
                                            <a href="@Url.Action("FAQ", "Home")" class="green-light-text text-decoration-none button-hover p-1 ms-3">
                                                <i class="fa-solid fa-question"></i> Frequent questions
                                            </a>
                                        </li>
                                        <li>
                                            <a href="@Url.Action("About", "Home")" class="green-light-text text-decoration-none button-hover p-1 ms-3">
                                                <i class="fa-solid fa-people-group"></i> About Us
                                            </a>
                                        </li>
                                        <li>
                                            <a href="" class="green-light-text text-decoration-none button-hover p-1 ms-3">
                                                <i class="fa-solid fa-book-open-reader"></i> How to use Zoodex
                                            </a>
                                        </li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- Side widget-->
                    <div class="card mb-4">
                        <div class="card-header">
                            Need help?
                        </div>
                        <div class="card-body">Contact Us: <a href="mailto:proyecto.zoodex@gmail.com" class="green-light-text text-decoration-none button-hover">Support Zoodex <i class="fa-solid fa-message"></i></a></div>
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {
        <div class="bg-main-header main-header relative">
            <div class="flex bg-main-header bg-black bg-opacity-50 items-center justify-center">
                <div class="text-center mx-2 mt-3">
                    <h1 class="text-green fw-bold display-1">
                        <span class="text-white">Easily </span><span class="text-white">identify </span>REPTILES
                    </h1>
                    <h2 class="display-3 fw-bold">
                        And<span class="text-white"> get information about </span>them
                    </h2>
                    <div class="inline-flex">
                        <a href="@Url.Action("Register", "Access")" class="btn bg-green text-white rounded border-2 border-transparent button-hover fs-3 p-2 my-5 mx-2 fw-bold" role="button">
                            Sign Up
                        </a>
                        <a href="@Url.Action("Index", "Access")" class="btn bg-transparent text-white border-2 bg-opacity-75 button-hover fs-3 p-2 my-5 mx-2 fw-bold" role="button">
                            Log In
                        </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="container py-5">
            <div class="row">
                <div class="col-md-12">
                    <div class="main-steps">
                        <div class="step">
                            <div class="step-icon"><i class="fa-solid fa-paper-plane"></i>></div>
                            <span class="number">1</span>
                            <div class="step-content">
                                <h5 class="title">STEP 1 - REGISTER</h5>
                                <p class="description">
                                    Register for free on our page <br />
                                    Once you sign up for Zoodex, log in so you can start using it.
                                </p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-icon"><i class="fa-solid fa-camera"></i></div>
                            <span class="number">2</span>
                            <div class="step-content">
                                <h5 class="title">STEP 2 - TAKE A PHOTO</h5>
                                <p class="description">
                                    Upload a photo of the reptile you wish to analyze to Zoodex <br />
                                    Upload a photo from your device so you can analyze your reptile.
                                </p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-icon"><i class="fa-solid fa-server"></i></div>
                            <span class="number">3</span>
                            <div class="step-content">
                                <h5 class="title">STEP 3 - ANALYZE</h5>
                                <p class="description">
                                    Press the Analyze button <br />
                                    Using AI algorithms, <br />
                                    Zoodex will provide you with information according to the species captured.
                                </p>
                            </div>
                        </div>
                        <div class="step">
                            <div class="step-icon"><i class="fa-solid fa-mobile-screen-button"></i></div>
                            <span class="number">4</span>
                            <div class="step-content">
                                <h5 class="title">STEP 4 - OBSERVE</h5>
                                <p class="description">
                                    Check the results obtained <br />
                                    Observe the results that Zoodex obtained thanks to the image of the reptile that was added.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    }
</section>

@section scripts {
    <script>
        $(document).ready(function () {
            if ("@TempData["Errors"]" != "") {
                new Toast({
                    message: "@TempData["Errors"]",
                    type: "danger"
                });
            }
            else if ("@TempData["Success"]" != "") {
                new Toast({
                    message: "@TempData["Success"]",
                    type: "success"
                });
            }

        });
    </script>
}